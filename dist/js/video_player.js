function initAPP(){var e;$.getJSON("src/omdb_id.json").then(function(o){moviesArray=o.movies,e=randomMovies(o.movies.length),displayDescriptionBox(moviesArray[e],"JSON"),displayVideoBoxes(moviesArray)})}function randomMovies(e){return Math.floor(Math.random()*e)}function sendAjaxRequest(e){var o;return $.ajax({url:e,type:"GET",dataType:"json",async:!1,success:function(e){o=e}}),o}function getMovieData(e,o){var t,a,n,d,s,r;if("ID"===e||"TITLE"===e)return t="https://www.omdbapi.com/",n="&apikey=3a2d81a4",a="ID"===e?"?i=":"?t=",requestURl=t+a+o+n,s=sendAjaxRequest(requestURl);if(t="https://api.themoviedb.org/3/movie/",n="?api_key=fa9a488e23b87c8ef52a33bfa830cbe1","DESC"==e||"URL"==e){if("DESC"==e)return d="&language=pl-PL",requestURl=t+o+n+d,s=sendAjaxRequest(requestURl),s.overview;for(d="&append_to_response=videos",requestURl=t+o+n+d,s=sendAjaxRequest(requestURl),i=1;i<s.videos.results.length;i++)if(1080==(r=s.videos.results[i]).size||720==r.size)return r.key;return s.videos.results[0].key}}function displayDescriptionBox(e,o){var t,i;"JSON"===o?t=getMovieData("ID",e.id):"OMDB"===o&&(t=getMovieData("ID",e.imdbID)),t.Plot=getMovieData("DESC",t.imdbID),$(".filmTitle").text(t.Title),$(".filmGenre").text(t.Genre),$(".filmDirector").text(t.Director),$(".filmWriter").text(t.Writer),$(".filmActors").text(t.Actors),$(".filmAwards").text(t.Awards),$(".filmRating").text(t.imdbRating),$(".filmYear").text(t.Year),$(".filmRuntime").text(t.Runtime),$(".filmPoster").attr("src",t.Poster),t.Plot.length>250?(i=t.Plot.indexOf(". ",180),$(".shortDescription").text(t.Plot.slice(0,i+1)),$(".longDescription").text(t.Plot.slice(i+1,t.Plot.length))):$(".shortDescription").text(t.Plot),$(".btnWatchVideo").attr("data-video-id",t.imdbID),$(".btnShowIMDB").attr("data-video-id",t.imdbID),$("#videoBackground").attr("poster",t.Poster)}function displayVideoBoxes(e){var o,t;for(i=0;i<e.length;i++)o=getMovieData("ID",e[i].id),t="",t+='<div class="videoBox" ',t+='data-video-id="'+e[i].id+'">',t+='<img src="'+o.Poster+'">',t+='<i class="fa fa-play-circle"></i>',t+="<p>"+o.Title+"</p>",t+="</div>",$(".videoBoxes").append(t);setVideoRows(4)}function menuSearchDisplay(e){"show"==e?(smallBox.style.display="none",expandedBox.style.display="block",menuSearch.classList.add("mouseSearchClick")):"hide"==e&&(smallBox.style.display="block",expandedBox.style.display="none",menuSearch.classList.remove("mouseSearchClick")),expandedBox.value="Wpisz film"}function searchInput(e){displayDescriptionBox(getMovieData("TITLE",e),"OMDB")}function openVideoModal(e){var o="";o+='<video id="modalVideo"',o+=' class="video-js vjs-big-play-centered vjs-default-skin vjs-16-9"',o+=' autoplay preload="auto" controls>',o+=' <source src="http://www.youtube.com/watch?v='+e+'"',o+=' type="video/youtube">',o+="</video>",modal.classList.add("modalOpen"),$(".modalWindow").append(o)}function playVideoInModal(){(player=videojs("modalVideo")).ready(function(){player.currentTime(5),player.volume(.5),player.play()}),player.on("ended",function(){modal.classList.remove("modalOpen"),player.dispose()})}function eventListenerVideoBox(){var e,o;expandedBox.addEventListener("click",function(e){expandedBox.value="",console.log("klick"),e.stopPropagation()},!0),menuSearch.addEventListener("mouseenter",function(){menuSearchDisplay("show"),console.log("wejscie")}),menuSearch.addEventListener("mouseleave",function(){menuSearchDisplay("hide"),console.log("wyjscie")}),menuSearch.addEventListener("keyup",function(e){13==(e.which||e.keyCode)&&(scrollViewTo("#heroImage"),hamburgerMenu(),searchInput(expandedBox.value),menuSearchDisplay("hide"))}),btnShowIMDB.addEventListener("click",function(){window.open($(".btnShowIMDB").attr("data-url"))}),btnWatchVideo.addEventListener("click",function(){e=$(".btnWatchVideo").attr("data-video-id"),openVideoModal(o=getMovieData("URL",e)),playVideoInModal()}),videoBoxes.addEventListener("click",function(t){var i=t.target.parentNode;"videoBox"==i.className&&(e=$(i).attr("data-video-id"),openVideoModal(o=getMovieData("URL",e)),playVideoInModal())}),window.addEventListener("keydown",function(e){27==(e.which||e.keyCode)&&(modal.classList.remove("modalOpen"),player.dispose()),32==(e.which||e.keyCode)&&(!0===player.paused()?player.play():player.pause(),e.preventDefault())}),closeModal.addEventListener("click",function(){modal.classList.remove("modalOpen"),player.dispose()})}var btnWatchVideo=document.querySelector(".btnWatchVideo"),btnShowIMDB=document.querySelector(".btnShowIMDB"),menuSearch=document.querySelector(".menuSearch"),expandedBox=document.querySelector(".expandedBox"),smallBox=document.querySelector(".smallBox"),expandedBox=document.querySelector(".expandedBox"),closeModal=document.querySelector(".fa-window-close-o"),videoBoxes=document.querySelector("#videoSection .videoBoxes"),modal=document.querySelector(".modalBackground"),player;initAPP(),eventListenerVideoBox();